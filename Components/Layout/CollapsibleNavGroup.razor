@* CollapsibleNavGroup.razor *@
@rendermode InteractiveServer

<div class="collapsible-nav-group nav-item px-3">
    <button class="group-header-btn @(IsExpanded ? "expanded" : "")" 
            @onclick="Toggle" 
            type="button">
        <span class="@Icon" aria-hidden="true"></span>
        @if (!IconOnly)
        {
            <span class="group-title-text">@Title</span>
            <span class="toggle-chevron bi bi-chevron-right"></span>
        }
    </button>
    
    @if (IsExpanded && !IconOnly)
    {
        <div class="group-children-content">
            @ChildContent
        </div>
    }
</div>

@code {
    [Parameter]
    public string Title { get; set; } = string.Empty;

    [Parameter]
    public string Icon { get; set; } = "bi bi-folder";

    [Parameter]
    public bool StartExpanded { get; set; } = false;

    [Parameter]
    public bool IconOnly { get; set; } = false;

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    private bool IsExpanded { get; set; }

    protected override void OnInitialized()
    {
        IsExpanded = StartExpanded;
    }

    protected override void OnParametersSet()
    {
        // Auto-collapse when IconOnly is true
        if (IconOnly)
        {
            IsExpanded = false;
        }
    }

    private void Toggle()
    {
        if (!IconOnly)
        {
            IsExpanded = !IsExpanded;
        }
    }
}